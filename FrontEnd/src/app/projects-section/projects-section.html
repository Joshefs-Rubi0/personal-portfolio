<div class="overlay-blur fixed inset-0 z-[999998] bg-black/95 backdrop-blur-3xl" 
     (click)="toggleExpand(null)" style="display: none; opacity: 0;">
</div>

<div class="window-modern" [class.show-flex]="activeProject !== null">
  <div class="p-4 md:p-8 flex justify-end sticky top-0 z-[10001]">
    <button (click)="toggleExpand(null)" class="btn-close-modern">
      <div class="btn-circle-bg"></div>
      <svg class="relative z-10" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
  </div>
  
  <div class="content-holder overflow-y-auto flex-1 px-6 pb-20 md:px-32 custom-scrollbar">
     <div class="max-w-6xl mx-auto flex flex-col gap-10 mt-4" *ngIf="activeProject">
        <img [src]="activeProject.image" class="w-full h-[40vh] md:h-[65vh] object-cover rounded-[2rem] md:rounded-[3rem] border border-white/10 shadow-2xl">
        <div class="space-y-8 md:space-y-12 pb-20">
            <h1 class="text-4xl md:text-8xl font-bold tracking-tighter text-white">{{ activeProject.title }}</h1>
            <p class="text-xl md:text-3xl text-gray-300 font-light leading-snug">{{ activeProject.description }}</p>
            <a [href]="activeProject.demo_link" target="_blank" class="inline-block bg-white text-black px-10 md:px-14 py-4 md:py-6 rounded-full font-bold text-lg md:text-2xl transition-all hover:scale-105 shadow-xl">Ver Proyecto Live</a>
        </div>
     </div>
  </div>
</div>

<div class="w-full text-white py-24 md:py-32 bg-[#0a0a0a] component-base min-h-screen">
  <div class="text-center mb-12 md:mb-20 px-6 mt-16">
    <h2 class="section-title text-4xl md:text-7xl font-bold tracking-tight text-white leading-[1.1]">
      Mis proyectos <br> destacados
    </h2>
  </div>

  <div class="flex justify-center mb-24 px-4">
    <div class="inline-flex p-2 bg-white/5 rounded-full border border-white/10 gap-2">
      @for (cat of categories; track cat) {
        <button (click)="selectCategory(cat)" 
                [class.active-pill]="selectedCategory === cat" 
                class="pill-item px-8 py-3 rounded-full text-sm font-medium">
          {{ cat }}
        </button>
      }
    </div>
  </div>

  <div class="max-w-[85rem] mx-auto px-4 md:px-8 pb-32 relative">
    @for (p of filteredProjects; track p.title; let i = $index) {
      <div class="card-main group relative" (click)="toggleExpand(p)" style="top: 110px;" [style.z-index]="i + 1">
        
        <div class="btn-expand-wrapper absolute top-6 right-6 md:top-10 md:right-10 z-20">
           <div class="icon-circle-bg"></div>
           <svg class="relative z-10 text-white/30 transition-colors" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/></svg>
        </div>

        <div class="flex flex-col lg:flex-row items-center gap-6 md:gap-14 p-6 md:p-14 w-full h-full">
            <div class="lg:w-[55%] w-full h-56 md:h-[450px] relative overflow-hidden rounded-2xl md:rounded-3xl">
              <img [src]="p.image" class="w-full h-full object-cover project-img-zoom">
            </div>

            <div class="lg:w-[45%] w-full space-y-4 md:space-y-6">
              <h3 class="text-3xl md:text-6xl font-bold tracking-tight text-white">{{ p.title }}</h3>
              <p class="text-gray-400 text-base md:text-xl font-light">{{ p.description }}</p>
              <div class="pt-2 flex items-center gap-3 text-blue-400 font-medium group-hover:translate-x-2 transition-all">
                <span>Explorar caso</span>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m9 18 6-6-6-6"/></svg>
              </div>
            </div>
        </div>
      </div>
    }
  </div>
</div>